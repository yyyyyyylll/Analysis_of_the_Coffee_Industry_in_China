<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å’–å•¡äº§å“åˆ†ç±»æ€ç»´å¯¼å›¾</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ä¿æŒä¸­æ–‡å­—ä½“ç¾è§‚å’Œä¸€è‡´æ€§ */
        body {
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
            background-color: #ffffff;
            overflow-x: auto; /* å…è®¸æ°´å¹³æ»šåŠ¨ä»¥é€‚åº”å†…å®¹æ‰©å±• */
        }

        /* èŠ‚ç‚¹åŸºæœ¬æ ·å¼ */
        .node {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 9999px; /* èƒ¶å›Šå½¢çŠ¶ */
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05); 
            transition: all 0.3s ease;
            transform-origin: left; /* åŠ¨ç”»ä»å·¦ä¾§å±•å¼€ */
            white-space: nowrap; /* é˜²æ­¢èŠ‚ç‚¹å†…å®¹æ¢è¡Œ */
        }

        /* é¼ æ ‡æ‚¬åœäº¤äº’æ•ˆæœ */
        .node:hover {
            transform: scale(1.03);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.1);
        }
        
        /* -------- æ ¸å¿ƒå¸ƒå±€ CSS (æ¨ªå‘æ ‘) --------- */
        
        #mindmap-root {
            /* ç¡®ä¿å†…å®¹ä»å·¦ä¸Šè§’å¼€å§‹ï¼Œå¹¶æä¾›è¶³å¤Ÿçš„å†…è¾¹è· */
            display: flex;
            align-items: flex-start;
            padding: 40px 20px;
            min-height: 80vh; 
        }

        /* æ ¹èŠ‚ç‚¹å’Œä¸»åˆ†æ”¯å®¹å™¨ (æ°´å¹³æ’åˆ—) */
        .root-branch-container {
            display: flex;
            align-items: center;
            width: auto;
        }
        
        /* å³ä¾§ä¸»åˆ†æ”¯åˆ—è¡¨åŒºåŸŸï¼šåŒ…å«å‚ç›´çº¿å’Œåˆ—è¡¨ */
        .main-branches-area {
            position: relative;
            display: flex;
            align-items: center; /* ç¡®ä¿å‚ç›´çº¿å’Œåˆ—è¡¨æ°´å¹³å¯¹é½ */
        }

        /* æ ¹èŠ‚ç‚¹æ ‡ç­¾æ ·å¼ */
        .root-label {
            z-index: 50;
            flex-shrink: 0;
            margin-right: -4px; /* ç¨å¾®è¦†ç›–è¿æ¥çº¿ */
        }
        
        /* è¿æ¥æ ¹èŠ‚ç‚¹åˆ°ä¸»åˆ†æ”¯çš„çº¿æ¡ (å¤§æ‹¬å·/ä¸»å¹²) */
        .root-connector-line {
            position: absolute;
            left: 0;
            width: 4px; /* å‚ç›´çº¿å®½åº¦ */
            background-color: #d1d5db; 
            z-index: 1;
            /* å®é™…é«˜åº¦å°†åœ¨ JS ä¸­è®¡ç®—å¹¶è®¾ç½® */
        }

        /* ä¸»åˆ†æ”¯åˆ—è¡¨å®¹å™¨ */
        .main-branch-list {
            list-style: none;
            padding: 0;
            margin: 0;
            margin-left: 20px; /* ç¡®ä¿åˆ—è¡¨åœ¨å‚ç›´çº¿å³ä¾§ */
        }

        .branch {
            list-style: none;
            position: relative;
            /* ç§»é™¤ branch è‡ªèº«çš„ margin-leftï¼Œç”±çˆ¶å®¹å™¨æ§åˆ¶ */
        }

        /* å­èŠ‚ç‚¹åˆ—è¡¨å®¹å™¨ (æ‰€æœ‰å­èŠ‚ç‚¹çš„çˆ¶å®¹å™¨) */
        .tree-container {
            position: relative;
            /* ç¡®ä¿å­åˆ†æ”¯æ°´å¹³æ’åˆ—åœ¨çˆ¶èŠ‚ç‚¹å³ä¾§ */
            padding-left: 30px; 
            padding-top: 5px;
        }

        /* å‚ç›´è¿æ¥çº¿ (ç”¨äºäºŒçº§åŠä»¥ä¸‹åˆ†æ”¯) */
        .tree-container:before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 100%;
            background-color: #e5e7eb;
        }

        /* æ°´å¹³è¿æ¥çº¿ (è¿æ¥çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹) */
        .branch .node:before {
            content: "";
            position: absolute;
            top: 19px; /* å‚ç›´å±…ä¸­ */
            left: -30px; /* ä»å·¦ä¾§è¿æ¥çº¿å¤„å¼€å§‹ */
            width: 30px;
            height: 2px;
            background-color: #e5e7eb;
            z-index: 10;
        }
        
        /* äº¤å‰ç‚¹åœ†ç‚¹ */
        .branch .node:after {
            content: "";
            position: absolute;
            top: 17px; 
            left: -32px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: #d1d5db;
            z-index: 20;
        }
        
        /* æ ¹èŠ‚ç‚¹çš„ä¸»åˆ†æ”¯ä¸éœ€è¦å·¦ä¾§è¿æ¥çº¿ */
        .main-branch-list > .branch .node:before,
        .main-branch-list > .branch .node:after {
            display: none;
        }
        
        /* ------------------ éšè—æ”¶èµ·çš„å†…å®¹ ------------------ */
        .collapsed > .tree-container {
            display: none;
        }
    </style>
</head>
<body class="p-4 sm:p-8 text-gray-800">

    <h1 class="text-3xl font-bold text-center mb-10 text-amber-800">â˜•ï¸ ä¸­å›½å’–å•¡è¡Œä¸šèµ›é“åˆ’åˆ†</h1>

    <div id="mindmap-root">
        <!-- Mind map will be rendered here -->
    </div>

    <script>
        // æ€ç»´å¯¼å›¾æ•°æ®ç»“æ„ (åŸºäºæä¾›çš„åˆ†ç±»)
        const mindMapData = {
            label: "å’–å•¡ (Coffee)",
            icon: "â˜•ï¸",
            color: "bg-amber-100 border-amber-300 text-amber-800", // ä¸»é¢˜è‰²ï¼šæ¸©æš–å’–å•¡è‰²
            children: [
                {
                    label: "ç°åˆ¶å’–å•¡",
                    icon: "âœ¨",
                    color: "bg-green-50 border-green-300 text-green-700",
                    children: [
                        {
                            label: "å’–å•¡ä¸“é¥®åº—",
                            color: "bg-white border-gray-300 text-gray-700",
                            children: [
                                { label: "è¿é”å’–å•¡åº—", icon: "ğŸ”—", color: "bg-blue-50 border-blue-200 text-blue-600" },
                                { label: "ç‹¬ç«‹å’–å•¡åº—", icon: "ğŸ ", color: "bg-blue-50 border-blue-200 text-blue-600" },
                            ]
                        },
                        {
                            label: "å…¶ä»–æ¸ é“",
                            color: "bg-white border-gray-300 text-gray-700",
                            children: [
                                { label: "å¿«é¤åº—å’–å•¡", icon: "ğŸ”", color: "bg-red-50 border-red-200 text-red-600" },
                                { label: "èŒ¶é¥®åº—å’–å•¡", icon: "ğŸ¹", color: "bg-red-50 border-red-200 text-red-600" },
                                { label: "ä¾¿åˆ©åº—å’–å•¡", icon: "ğŸª", color: "bg-red-50 border-red-200 text-red-600" },
                                { label: "è‡ªåŠ©å’–å•¡æœº", icon: "ğŸ¤–", color: "bg-red-50 border-red-200 text-red-600" },
                            ]
                        }
                    ]
                },
                {
                    label: "åŒ…è£…/é›¶å”®",
                    icon: "ğŸ“¦",
                    color: "bg-blue-50 border-blue-300 text-blue-700",
                    children: [
                        { label: "å³é¥®å’–å•¡", icon: "ğŸ¥¤", color: "bg-white border-gray-300 text-gray-700" },
                        {
                            label: "å’–å•¡è±†/ç²‰",
                            color: "bg-white border-gray-300 text-gray-700",
                            children: [
                                { label: "é€Ÿæº¶å’–å•¡", icon: "ğŸ¥„", color: "bg-yellow-50 border-yellow-200 text-yellow-700" },
                                { label: "æŒ‚è€³å’–å•¡", icon: "ğŸ’§", color: "bg-yellow-50 border-yellow-200 text-yellow-700" },
                                { label: "èƒ¶å›Šå’–å•¡", icon: "ğŸ’Š", color: "bg-yellow-50 border-yellow-200 text-yellow-700" },
                                { label: "åŸç”Ÿè±†/ç²‰", icon: "ğŸŒ±", color: "bg-yellow-50 border-yellow-200 text-yellow-700" },
                            ]
                        }
                    ]
                }
            ]
        };

        /**
         * åˆ‡æ¢èŠ‚ç‚¹å±•å¼€/æ”¶èµ·çŠ¶æ€
         * @param {Event} event 
         */
        function toggleNode(event) {
            const nodeElement = event.currentTarget.parentNode;
            const childrenContainer = nodeElement.querySelector('.tree-container');
            const arrowIcon = event.currentTarget.querySelector('.arrow-icon');
            
            if (childrenContainer) {
                const isCollapsed = childrenContainer.classList.toggle('hidden');
                nodeElement.classList.toggle('collapsed', isCollapsed); 
                
                // åˆ‡æ¢ç®­å¤´æ–¹å‘
                if (arrowIcon) {
                    arrowIcon.classList.toggle('rotate-90', !isCollapsed);
                }
            }
        }

        /**
         * é€’å½’æ¸²æŸ“æ€ç»´å¯¼å›¾èŠ‚ç‚¹
         * @param {Object} data èŠ‚ç‚¹æ•°æ®
         * @param {boolean} isRootLevel æ˜¯å¦æ˜¯æ ¹èŠ‚ç‚¹ä¸‹çš„ä¸€çº§å­èŠ‚ç‚¹
         * @returns {HTMLElement} èŠ‚ç‚¹å…ƒç´ 
         */
        function renderNode(data, isRootLevel = false) {
            const nodeWrapper = document.createElement('li');
            nodeWrapper.classList.add('branch', 'mt-4', 'mb-4', 'relative');
            
            // èŠ‚ç‚¹æ ‡ç­¾å…ƒç´ 
            const nodeLabel = document.createElement('div');
            nodeLabel.classList.add('node', 'border', 'text-sm', 'font-semibold', 'max-w-xs', 'relative', 'z-20');
            nodeLabel.classList.add(...data.color.split(' '));
            
            // ç®­å¤´å›¾æ ‡
            const arrowIcon = document.createElement('span');
            arrowIcon.classList.add('arrow-icon', 'mr-2', 'transition-transform', 'duration-300', 'text-gray-600');
            arrowIcon.innerHTML = 'â–¶'; 

            // æ ‡ç­¾å†…å®¹
            const labelContent = document.createElement('span');
            labelContent.textContent = (data.icon ? data.icon + ' ' : '') + data.label;
            
            if (data.children && data.children.length > 0) {
                nodeLabel.prepend(arrowIcon);
                nodeLabel.addEventListener('click', toggleNode);
            } else {
                // å¶å­èŠ‚ç‚¹æ ·å¼
                nodeLabel.classList.add('shadow-none'); 
            }

            nodeLabel.appendChild(labelContent);
            nodeWrapper.appendChild(nodeLabel);

            if (data.children && data.children.length > 0) {
                // å­èŠ‚ç‚¹åˆ—è¡¨å®¹å™¨
                const childrenContainer = document.createElement('ul');
                childrenContainer.classList.add('tree-container', 'branch-list');
                
                data.children.forEach(childData => {
                    childrenContainer.appendChild(renderNode(childData, false));
                });
                
                nodeWrapper.appendChild(childrenContainer);
                
                // é»˜è®¤å±•å¼€ç¬¬ä¸€çº§å­èŠ‚ç‚¹
                if (isRootLevel) {
                     arrowIcon.classList.add('rotate-90'); 
                } else {
                    // å…¶ä»–èŠ‚ç‚¹é»˜è®¤æ”¶èµ·
                    childrenContainer.classList.add('hidden');
                    nodeWrapper.classList.add('collapsed');
                }
            }
            
            return nodeWrapper;
        }

        function initMindMap() {
            const rootElement = document.getElementById('mindmap-root');
            rootElement.innerHTML = '';
            
            // 1. æ ¹èŠ‚ç‚¹ (æœ€å·¦è¾¹)
            const rootLabel = document.createElement('div');
            rootLabel.classList.add('node', 'border', 'text-xl', 'font-extrabold', 'shadow-xl', 'text-center', 'cursor-default', 'root-label');
            rootLabel.classList.add(...mindMapData.color.split(' '));
            rootLabel.textContent = mindMapData.icon + ' ' + mindMapData.label;
            
            // 2. å³ä¾§ä¸»åˆ†æ”¯åˆ—è¡¨åŒºåŸŸ
            const mainBranchesArea = document.createElement('div');
            mainBranchesArea.classList.add('main-branches-area');
            
            const mainBranchList = document.createElement('ul');
            mainBranchList.classList.add('main-branch-list', 'ml-0');
            
            // ç”¨äºè®¡ç®—å‚ç›´çº¿é«˜åº¦çš„å®¹å™¨
            const listWrapper = document.createElement('div');
            listWrapper.classList.add('relative');
            
            // æ¸²æŸ“ä¸¤ä¸ªä¸»è¦åˆ†æ”¯ (ç°åˆ¶å’–å•¡ and åŒ…è£…/é›¶å”®)
            mindMapData.children.forEach(childData => {
                const branchItem = document.createElement('li');
                branchItem.classList.add('branch', 'mt-4', 'mb-4', 'relative');
                
                // æ¸²æŸ“èŠ‚ç‚¹
                const renderedNode = renderNode(childData, true);
                
                // å°† renderedNode çš„å­å…ƒç´ ç§»åŠ¨åˆ° branchItem ä¸­
                while (renderedNode.firstChild) {
                    branchItem.appendChild(renderedNode.firstChild);
                }
                
                // æ·»åŠ æ°´å¹³çº¿ä»æ ¹èŠ‚ç‚¹åˆ°ä¸»åˆ†æ”¯
                const mainHorizontalLine = document.createElement('div');
                // 40px çš„æ°´å¹³çº¿ï¼Œä»å·¦ä¾§è¿æ¥åˆ°å‚ç›´çº¿
                mainHorizontalLine.classList.add('absolute', 'h-0.5', 'bg-gray-300', 'top-1/2', '-translate-y-1/2', 'left-[-40px]', 'w-10', 'z-10'); 
                branchItem.appendChild(mainHorizontalLine);
                
                mainBranchList.appendChild(branchItem);
            });
            
            listWrapper.appendChild(mainBranchList);
            mainBranchesArea.appendChild(listWrapper);
            
            // 3. æ ¹èŠ‚ç‚¹å’Œä¸»åˆ†æ”¯çš„å¯¹é½
            const overallWrapper = document.createElement('div');
            overallWrapper.classList.add('flex', 'items-center', 'w-full');
            overallWrapper.appendChild(rootLabel);
            
            // 4. å‚ç›´è¿æ¥çº¿ï¼ˆå¤§æ‹¬å·çš„å‚ç›´éƒ¨åˆ†ï¼‰
            // åœ¨ JS ä¸­åŠ¨æ€åˆ›å»ºå‚ç›´çº¿ï¼Œä½¿å…¶ä¸ä¸»åˆ†æ”¯åˆ—è¡¨é«˜åº¦å¯¹é½
            const mainVerticalLine = document.createElement('div');
            mainVerticalLine.classList.add('root-connector-line');
            mainBranchesArea.prepend(mainVerticalLine); // æ”¾åœ¨åˆ—è¡¨å‰
            
            overallWrapper.appendChild(mainBranchesArea);
            rootElement.appendChild(overallWrapper);

            // 5. å»¶è¿Ÿè®¡ç®—å¹¶è®¾ç½®å‚ç›´çº¿é«˜åº¦ (å¿…é¡»åœ¨å…ƒç´ æ·»åŠ åˆ° DOM åæ‰èƒ½è·å–é«˜åº¦)
            window.requestAnimationFrame(() => {
                const listHeight = mainBranchList.offsetHeight;
                // å‚ç›´çº¿çš„é«˜åº¦è¦†ç›–æ•´ä¸ªåˆ—è¡¨ï¼Œå¹¶å‘ä¸Š/å‘ä¸‹å»¶ä¼¸ä¸€ç‚¹ç‚¹
                mainVerticalLine.style.height = `${listHeight + 20}px`; 
                mainVerticalLine.style.top = `-10px`; // å‘ä¸Šç§»åŠ¨ 10px
            });
        }

        window.onload = initMindMap;
    </script>
</body>
</html>