<!doctype html>
<html lang=zh-CN>
<head>
  <meta charset=utf-8>
  <meta name=viewport content=width=device-width,initial-scale=1>
  <title>消费者咖啡饮用频次</title>
  <script src=https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js></script>
  <style>
    html,body{height:100%;margin:0;background:#fbf7f1;}
    body{
    display: flex;
    justify-content: center;  /* 水平居中 */
    align-items: center;      /* 垂直居中 */
    background: #fbf7f1;
  }
    #main{width:100%;max-width:980px;height:680px;margin:0 auto;}
  </style>
</head>

<body>
  <div id=main></div>

  <script>
    const dom = document.getElementById(`main`);
    const chart = echarts.init(dom);

    const categories = [
      `一天一杯以上`,
      `每周2-3杯`,
      `每周一杯`,
      `每月2-3杯`,
      `没有固定规律`,
      `基本不喝`
    ];

    const data2024 = [14.15, 32.08, 28.11, 8.68, 10.00, 6.98];
    const data2025 = [14.55, 32.97, 30.42, 8.97, 7.76, 5.33];

    const baseColors = [
      `#FFC23A`,
      `#E07A00`,
      `#B45309`,
      `#A3A3A3`,
      `#CFCFCF`,
      `#E5E5E5`
    ];

    function hexToRgb(hex){
      const h = hex.replace(`#`, ``);
      const r = parseInt(h.slice(0,2), 16);
      const g = parseInt(h.slice(2,4), 16);
      const b = parseInt(h.slice(4,6), 16);
      return { r, g, b };
    }
    function lighten(hex, amount){
      const a = amount == null ? 0.62 : amount;
      const c = hexToRgb(hex);
      const r = Math.round(c.r + (255 - c.r) * a);
      const g = Math.round(c.g + (255 - c.g) * a);
      const b = Math.round(c.b + (255 - c.b) * a);
      return `rgb(${r},${g},${b})`;
    }

    const innerColors = baseColors.map(c => lighten(c, 0.62));

    const innerData = categories.map((name, i) => ({
      name,
      value: data2024[i],
      itemStyle: { color: innerColors[i] }
    }));

    const outerData = categories.map((name, i) => ({
      name,
      value: data2025[i],
      itemStyle: { color: baseColors[i] }
    }));

    const centerXY = [`50%`, `52%`];

    const option = {
      backgroundColor: `#fbf7f1`,
      title: {
        text: `消费者咖啡饮用频次（%）`,
           subtext: "2024与2025对比（单位：%）",
        left: `center`,
        top: 0,
        textStyle: {
          color: `#2f2f2f`,
          fontSize: 26,
          fontWeight: 800,
          fontFamily: `system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Noto Sans SC,Helvetica,Arial`
        },
          subtextStyle: { fontSize: 16, color: "#777", lineHeight: 22 }
      },

      tooltip: {
        trigger: `item`,
        appendToBody: true,
        backgroundColor: `rgba(255,255,255,0.96)`,
        borderColor: `rgba(0,0,0,0.06)`,
        borderWidth: 1,
        extraCssText: `box-shadow:0 14px 40px rgba(0,0,0,0.12);border-radius:14px;padding:14px 14px;`,
        formatter: (p) => {
          const year = p.seriesName;
          const ring = year === `2024` ? `内圈（2024）` : `外圈（2025）`;
          const v = Number(p.value).toFixed(2);

          return `
            <div style=font-weight:800;font-size:16px;color:#111827;margin-bottom:6px>${p.name}</div>
            <div style=color:#6b7280;font-size:12px;margin-bottom:10px>${ring}</div>
            <div style=display:flex;align-items:baseline;gap:6px>
              <div style=font-weight:900;font-size:18px;color:#111827>${v}%</div>
            </div>
          `;
        }
      },

      legend: [
        {
          bottom: 5,
          left: `center`,
          itemWidth: 12,
          itemHeight: 12,
          icon: `circle`,
          data: categories,
          textStyle: {
            color: `#6b7280`,
            fontSize: 12,
            fontFamily: `system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Noto Sans SC,Helvetica,Arial`
          }
        }
      ],

      series: [
        {
          name: `2024`,
          type: `pie`,
          center: centerXY,
          radius: [`34%`, `56%`],
          clockwise: true,
          avoidLabelOverlap: true,
          label: { show: false },
          labelLine: { show: false },
          itemStyle: {
            borderColor: `#fbf7f1`,
            borderWidth: 4
          },
          emphasis: {
            scale: true,
            scaleSize: 10,
            itemStyle: {
              shadowBlur: 18,
              shadowColor: `rgba(210,140,60,0.25)`,
              shadowOffsetY: 10,
              borderWidth: 12
            }
          },
          data: innerData
        },
        {
          name: `2025`,
          type: `pie`,
          center: centerXY,
          radius: [`62%`, `84%`],
          clockwise: true,
          avoidLabelOverlap: true,
          label: { show: false },
          labelLine: { show: false },
          itemStyle: {
            borderColor: `#fbf7f1`,
            borderWidth: 4
          },
          emphasis: {
            scale: true,
            scaleSize: 12,
            itemStyle: {
              shadowBlur: 20,
              shadowColor: `rgba(210,140,60,0.30)`,
              shadowOffsetY: 12,
              borderWidth: 12
            }
          },
          data: outerData
        }
      ],


  graphic: [
    {
      type: `group`,
      left: centerXY[0],
      top: centerXY[1],
      bounding: `raw`,
      silent: true,

      z: 100,
      zlevel: 10,

      children: [
        {
          type: `text`,
          x: 0,
          y: -18,              // 上移一点
          style: {
            text: `2024`,
            fill: `#D97706`,
            fontSize: 46,      // 想更稳就再小一点
            fontWeight: 900,
            textAlign: `center`,
            textVerticalAlign: `middle`
          }
        },
        {
          type: `text`,
          x: 0,
          y: 26,               // 下移一点，和上面拉开
          style: {
            text: `2025`,
            fill: `#D97706`,
            fontSize: 46,
            fontWeight: 900,
            textAlign: `center`,
            textVerticalAlign: `middle`
          }
        }
      ]
    }
  ]
    };

    chart.setOption(option);

    window.addEventListener(`resize`, () => chart.resize());
  </script>
</body>
</html>
